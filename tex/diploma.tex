\input{./gost-template/preamble.tex}

\usepackage{microtype}
\usepackage[extdef]{delimset}
\usepackage{csquotes} % иначе babel делает ворнинг
\usepackage{ragged2e}
\usepackage[hidelinks]{hyperref}
\usepackage{subfig}
\usepackage{tabularray}


\renewcommand{\div}{\operatorname{div}}


\begin{document}

\setcounter{page}{2}

\input{./gost-template/toc.tex}

\structel{ВВЕДЕНИЕ}

Симбиотические двойные — это системы, в спектре которых можно выделить линии поглощения, характерные для холодных звёзд, и эмиссионные линии, характерные для горячих туманностей.

Предполагается, что они состоят из близко расположенных красного гиганта и белого карлика, которые традиционно называются холодным и горячим компонентами. Из-за гравитации белого карлика красный гигант перестаёт быть сферически симметрчиным и приобретает каплевидную форму. Кроме того, может происходить перенос массы с красного гиганта на белый карлик, за счёт чего образуется аккреционный диск. Вещество может перетекать с помощью звёздного ветра --- или напрямую с поверхности, если холодный компонент полностью заполняет свою полость Роша.

Поскольку красный гигант не является сферически симметричным, при движении по орбите его блеск меняется. Такая переменность называется эллипсоидальной. Помимо чисто геометрического эффекта, на переменность также влияет гравитационное потемнение --- зависимость температуры от ускорения силы тяжести в конкретной точке поверхности звезды. Из-за него полюса красного гиганта будут наиболее горячими и яркими, а «носик», расположенный на экваторе и направленный в сторону точки Лагранжа --- наиболее холодным.

В данной работе анализируются кривые блеска T Северной Короны, измеренные в Крымской обсерватории ГАИШ МГУ в 1996--2003 и 2008-2021. На их основе мы определяем соотношение масс компонентов и наклонение орбиты — то есть решаем обратную задачу.

T Северной Короны --- повторная новая. Она вспыхивала в 1866, 1946 и, предполагается, должна вспыхнуть в 2024 \cite{OutburstAnnounce}. Повторные новые возникают, когда на поверхности белого карлика скапливается достаточно много водорода, перетекшего с красного гиганта, и начинается термоядерная реакция. Светимость в результате повышается на ${\sim} 10$ звёздных величин и медленно снижается в течение десятков дней.

Цель работы --- получить распределение вероятностей наклонения и соотношения масс компонентов двойной звезды T Северной Короны.

Методами исследования являются компьютерное моделирование кривых блеска и статистический вывод. Мы применили байесовский подход, воспользовавшись библиотекой для вероятностного программирования Turing.jl \cite{Turing}.

Вероятностное программирование --- парадигма программирования, предназначенная для работы с вероятностными моделями, которая позволяет автоматизировать статистический вывод и проверку гипотез. Главными идеями вероятностного программирования является автоматизированное применение теоремы Байеса, которое позволяет получить апостериорное распределение вероятностей для параметров задачи, и семплирование из него с помощью марковских цепей. Байесовский подход позволяет легко комбинировать данные от разнородных наблюдений.

Задачами работы являются:
\begin{enumerate}
    \item Численное моделирование физики переменности, получение модельных кривых блеска.
    \item Построение вероятностной модели, учитывающей статистические свойства экспериментальных данных.
    \item Получение апостериорного распределения вероятностей для параметров модели (наклонение, соотношение масс) и семплирование из него.
    \item Анализ распределения, получение оценок параметров и их доверительных интервалов.
\end{enumerate}

Настоящая работа была представлена на конференции МФТИ в 2024.

Новизна исследования заключается в применении байесовского подхода к обратной задаче астрофизики.

Значимость работы заключается в получении оценок параметров двойной звезды T Северной Короны, создании вероятностной модели переменности, в которую можно добавлять реалистичные модели звёздных атмосфер, и которая может быть использована для анализа других симбиотических двойных.


\sect{Физика переменности}

Существует несколько типов переменных звёзд: затменные, пульсирующие и так далее. Считается, что T Северной Короны имеет \emph{эллипсоидальный} тип.

В рамках эллипсоидальной модели светимость в каждый момент времени определяется тремя эффектами: формой красного гиганта (мы предполгаем, что он заполняет свою полость Роша), гравитационным потемнением и потемнением к краю. В этой главе мы рассмотрим подробно каждый из трёх эффектов.

Белый карлик горячий и в основном излучает в ультрафиолете. Ультрафиолотовые наблюдения показывают, что затмения отсуствуют. Мы исследуем данные в инфракрасном канале, поэтому вклад белого карлика можно пренебречь.

\subsect{Форма полости Роша}

На вещество массой $dm$, находящееся в двойной звёздной системе, действуют три силы: гравитация красного гиганта, гравитация белого карлика и центробежная сила. Область, в которой преобладает гравитация какого-либо из компонентов, называется его полостью Роша. Если вещество оказывается за пределами полости Роша, то оно перетекает на другую звезду или в космическое пространство.

Суммарный потенциал трёх сил равен
\begin{equation}
\Omega = 
-\frac{G m_\text{giant}}{r_1}
-\frac{G m_\text{dwarf}}{r_2}
-\frac{1}{2} (\omega \times r_3)^2
\label{eq:roche_generic}
\end{equation}
где $m_\text{giant}$ и $m_\text{dwarf}$ --- массы двух звёзд, $r_1$ --- расстояние до центра гиганта, $r_2$ --- расстояние до центра карлика, $r_3$ --- расстояние до центра масс, $\omega$ --- угловая скорость вращения звёзд по орбите.

Вещество красного гиганта, находясь под действием потенциала $\Omega$, заполняет некоторую эквипотенциальную поверхность, на которой $\Omega = \text{const}$. Одной из эквипотенциальных поверхностей является полость Роша. Она проходит через точку Лагранжа $L_1$, где все силы уравновешиваются и $\nabla \Omega = 0$.

В уравнении \eqref{eq:roche_generic} неявно предполагается, что гравитационный потенциал можно заменить потенциалом точечного тела. Это приближение оправданно, поскольку внешняя оболочка красных гигантов имеет очень низкую плотность, и масса в основном сосредоточена в практически сферическом ядре.

Найдём форму полости Роша численно. Для этого введём систему координат с центром в ядре красного гиганта, и направим ось $x$ в сторону карлика. Обозначим расстояние между центрами звёзд как $a$. Тогда \eqref{eq:roche_generic} примет вид
\[
\Omega =
-\frac{G m_\text{giant}}{\sqrt{x^2 + y^2 + z^2}}
-\frac{G m_\text{dwarf}}{\sqrt{(x - a)^2 + y^2 + z^2}}
-\frac{1}{2} \omega^2 \brk*{\brk*{x - a \frac{m_\text{dwarf}}{m_\text{giant} + m_\text{dwarf}}}^2 + y^2}
\]

Если обезразмерить координаты $(r \to r / a)$, обозначить соотношение масс $m_\text{giant} / m_\text{dwarf} = q$ и заметить, что в силу третьего закона Кеплера $\omega^2 = \dfrac{G}{a^3} \brk!{m_\text{giant} + m_\text{dwarf}}$, то получится
\begin{align*}
\Omega 
&= - \frac{G m_\text{giant}}{a} \brk[s]*{
    \frac{1}{r}
    + \frac{q^{-1}}{\sqrt{1 + r^2 - 2x}}
    + \frac{1 + q^{-1}}{2} \brk*{\brk*{x - \frac{1}{1+q}}^2 + y^2}
} \\
&= - \frac{G m_\text{giant}}{a} \brk[s]*{
    \frac{1}{r}
    + q^{-1} \brk*{
        \frac{1}{\sqrt{1 + r^2 - 2x}} - x
    }
    + \frac{1 + q^{-1}}{2} \brk!{x^2 + y^2}
    + \frac{q^{-1}}{1 + q}
}
\end{align*}

Последний член является константой и может быть отброшен. Таким образом, безразмерный потенциал равен
\begin{equation}
\Omega = \frac{1}{r} + q^{-1} \brk*{
    \frac{1}{\sqrt{1 + r^2 - 2x}} - x
}
+ \frac{1 + q^{-1}}{2} \brk!{x^2 + y^2}
\label{eq:roche_dekart}
\end{equation}
Или, в сферических координатах,
\begin{equation}
\Omega = \frac{1}{r} + q^{-1} \brk*{
    \frac{1}{\sqrt{1 + r^2 - 2r n_x}} - r n_x
}
+ \frac{1 + q^{-1}}{2} r^2 (1 - n_z^2)
\label{eq:roche_spherical}
\end{equation}
где введены направляющие косинусы $n_x = x / r$, $n_z = z / r$.

Уравнение \eqref{eq:roche_spherical} позволяет численно определить форму полости Роша. Для этого достаточно для всех направлений $(n_x, n_y, n_z)$ решить уравнение $\Omega(r) = \Omega_0.$

В качестве $\Omega_0$ необходимо взять значение потенциала в точке Лагранжа $L_1$. Её положение мы находим, решив уравнение $\dfrac{\partial \Omega(x, 0, 0)}{\partial x} = 0$.


\subsect{Гравитационное потемнение}

Гравитационное потемнение --- явление, при котором температура поверхности звезды зависит от ускорения силы тяжести в данной точке. Обычно его описывают формулой
\begin{equation}
T_\text{eff} \sim g^\beta
\label{eq:gravity_darkening}
\end{equation}

Величина $\beta$ зависит от типа внешней оболочки звезды. У голубых гигантов непосредственно под фотосферой находится зона лучистого переноса, и $\beta = 0.25$. У других звёзд, в том числе красных гигантов, внешней является зона конвекции, и $\beta$ принято считать равным $0.08$.

За счёт гравитационного потемнения полюса быстро вращающихся звёзд ярче, чем экватор. В случае симбиотических двойных гравитационное потемнение тоже оказывает влияние.


\parag{Закон фон Зейпеля}

Проще всего вывести \eqref{eq:gravity_darkening} для зоны лучистого переноса.

Давление внутри звезды складывается из давления газа и давления излучения: $P = P_g + \dfrac{4}{3} \dfrac{\sigma}{c} T^4$.
Градиент давления должен уравновешивать силу тяжести:
\[
\nabla P = \rho \vec g = -\rho \nabla \Omega
\]

Если рассмотреть смещение вдоль некоторого вектора $e$, то $d\Omega = (e \cdot \nabla \Omega)$,
\[
dP = -\rho d\Omega
\]

В частности, при $d\Omega = 0$ также $dP = 0$. Следовательно, $P$ постоянно на эквипотенциальных поверхностях и является функцией $\Omega$. Более того, $\rho = -\dfrac{dP(\Omega)}{d\Omega}$ тоже является функцией $\Omega$.

Вещество звезды должно подчиняться некоторому уравнению состояния:
\[
f(P, \rho, T) = 0
\]

Каким бы оно ни было, если $P = P(\Omega)$ и $\rho = \rho(\Omega)$, то и $T = T(\Omega)$. Поэтому эквипотенциальные поверхности также являются изобарическими, изопикническими и изотермическими.

Для лучистого переноса верно диффузное приближение: световой поток равен
\begin{equation}
F = -D \nabla U
\label{eq:Fick}
\end{equation}
где $U = \dfrac{4}{c} \sigma T^4$ --- плотность энергии, $D = \dfrac{1}{3} l c$ --- коэффициент диффузии, $l$ --- длина свободного пробега фотонов.

$U$ зависит только от температуры, которая является функцией $\Omega$. Следовательно,
\[
F = - D U'(T) T'(\Omega) \nabla \Omega
\]

$l$ и $D$ зависят от $\rho$, которая тоже является функцией $\Omega$. Поэтому на эквипотенциальных поверхностях
\[
F = \text{const} \cdot \nabla \Omega = \text{const} \cdot g
\]

В астрономии часто вводят эффективную температуру $T_\text{eff}$. По определению, это такая температура, что выполняется закон Стефана-Больцмана: 
\[
F = \sigma T_\text{eff}^4
\]
Обратите внимание на расхождение с формулой лучистого переноса \eqref{eq:Fick}. Если обычная температура на эквипотенциальных поверхностях является константой, то эффективная подчиняется
\[
T_\text{eff} \sim g^{1/4}
\]

Таким образом, в зоне лучистого переноса выполняется уравнение \eqref{eq:gravity_darkening} с $\beta = 1/4$.
Впервые этот результат был получен фон Зейпелем ровно 100 лет назад \cite{vonZeipel}.


\parag{Закон Люси}

В зоне конвекции, в отличие от зоны лучистого переноса, всё не так однозначно. Наиболее цитируемый результат был получен Львом Люси в 1967 году \cite{Lucy}:
\[
T_\text{eff} \sim g^{0.08}
\]

Люси рассмотрел случай, когда в зоне конвекции, начиная с некоторой небольшой глубины, удельная энтропия постоянна. Тогда температуру и плотность связывает уравнение адиабаты:
\begin{equation*}
T \rho^{1 - \gamma} = K
\label{eq:adiabat}
\end{equation*}
где $\gamma = 5/3$ --- показатель адиабаты, $K$ --- некоторая константа (константа адиабаты), характеризующая конкретную звезду.

Уравнение адиабаты можно переписать в виде
\begin{equation}
\log K = \log T + (1 - \gamma) \log \rho
\label{eq:adiabat_log}
\end{equation}

Люси преположил, что константа адибаты зависит только от эффективной температуры и гравитации на поверхности:
\[
K(\log g, \log T_\text{eff}) = K_0
\]
Предположив $T \sim g^\beta$, можно получить
\[
\frac{\partial \log K}{\partial \log g}
+ \frac{\partial \log K}{\partial \log T_\text{eff}}
\underbrace{\frac{d \log T_\text{eff}}{d \log g}}_{\beta} = 0
\]
и выразить $\beta$ через частные производные:
\[
\beta = -\frac{\partial \log K / \partial \log g}{\partial \log K / \partial \log T_\text{eff}}
\]
Частные производные можно вычислить из \eqref{eq:adiabat_log}. Люси использовал для этого таблицы конвективных моделей звёзд из книги Бейкера (1963). Он получил, что $\beta$ слабо зависит как от соотношения между водородом и гелием, так и от соотношения между длиной смешивания и высотой однородной атмосферы. Для практических применений Люси предлагает использовать
\[
\beta \approx 0.08
\]
Именно это значение используется в настоящей работе.


\parag{Коэффициент Кларета}

Полученные выше законы $T_\text{eff} \sim g^{1/4}$ и $T_\text{eff} \sim g^{0.08}$ относится к болометрической светимости.
Но наблюдения, как правило, производятся в некоторой узкой полосе длин волн, причем спектр реальных звёзд далек от чернотельного.

Поэтому Антоний Кларет предлагает \cite{ClaretGravity} ввести коэффициент $y(\lambda)$, по определению равный
\begin{equation}
y(\lambda)
\coloneq \brk*{
    \frac{\partial \ln I(\lambda)}{\partial \ln g}
}_{T_\text{eff}}
+\brk*{
    \frac{\partial \ln I(\lambda)}{\partial \ln T_\text{eff}}
}_g
\brk3{
    \underbrace{
        \frac{d \ln T_\text{eff}}{d \ln g}
    }_{\beta}
}
\label{eq:ClaretGravity}
\end{equation}
где $I(\lambda)$ --- интенсивность излучения в полосе $\lambda$.

Кларет вычислил $y(\lambda)$ численно, используя модели ATLAS и PHOENIX. Оказалось, что $y(\lambda)$ зависит от эффективной температуры, гравитации и скорости микротурбулентности.

На рис. \ref{fig:ClaretGravity} показаны примеры полученных им зависимостей для инфракрасных фильтров $J$ и $K$.

\begin{figure}[h]
\centering
\subfloat{
    \includegraphics[height=0.4\textwidth]{pics/Claret GDC J.png}
}
\subfloat{
    \includegraphics[height=0.4\textwidth]{pics/Claret GDC K.png}
}
\caption{Коэффициент гравитационного потемнения \eqref{eq:ClaretGravity} для фильтров $J$ и $K$ в зависимости от эффективной температуры.
Звёздочками обозначена модель абсолютно черного тела, сплошной линией --- модель ATLAS, пунктирной --- PHOENIX. Параметры моделей: $\log g = 4$ см/с+2, $v_\text{mic} = 2$ км/с, металличность $\log [\text{M}/\text{H}] = 0$.
Изображения взяты из \cite{ClaretGravity}.}
\label{fig:ClaretGravity}
\end{figure}

Данный подход, хоть и является более правильным, не очень полезен для настоящей работы. Он позволяет вычислить производную интенсивности по гравитации при определенной температуре, но не позволяет напрямую получить распределение температур по поверхности звезды. Поэтому мы будем использовать простой закон $T_\text{eff} \sim g^{0.08}$.


\parag{Модель Лары-Рьётора}

Самую новую модель на сегодняшний день предложили в 2012 году Франческо Лара и Мишель Рьётор \cite{LaraRieutord}. Они приняли приближение, что поток излучения всегда антипараллелен гравитации:
\[
\vec F = -f(r, \theta, \varphi) \vec g
\]
где $f$ --- некоторая положительная функция, которую нужно найти.

В установившемся режиме всюду, кроме центра звезды, поток энергии должен сохраняться:
\[
\div F = 0
\]
Следовательно,
\[
\vec g \cdot \nabla f + f \nabla \cdot \vec g = 0
\]
Если ввести $\vec n = -\vec g / g$, то
\[
\vec n \cdot \nabla \log f = \frac{\nabla \cdot \vec g}{g}
\]
Решение можно получить, проинтегрировав это уравнение вдоль \emph{линии поля} --- кривой, которая в каждой точке касается вектора $\vec n$. Рассмотрим линию поля, которая начинается в точке $O$ (гравитационном центре звезды) и заканчивается в некоторой точке $A$. Тогда
\begin{equation*}
f(A) = f_0 \exp \left(
    {}\int\limits_O^A \frac{\nabla \cdot \vec g}{g} ds
\right)
\label{eq:LaraSolution}
\end{equation*}
где $f_0$ --- нормировочная константа, определяющаяся полной светимостью звезды.

Интеграл можно вычислить численно, выразив $g = \nabla \Omega$ с помощью формулы для потенциала Роша \eqref{eq:roche_spherical}.

Как показали Лара и Рьётор, в результате снова приблизительно получится степенной закон $T_\text{eff} \sim g^\beta$.

Величина $\beta$ зависит от соотношения масс компаньонов и процента заполнения полости Роша, авторы приводят соответствующие таблицы. Для большинства случаев $\beta$ лежит в интервале 0.20--0.25.

В пределе нулевого заполнения полости Роша, когда приливной деформацией можно пренебречь, $\beta \to 0.25$, что соответствует закону фон Зейпеля.

Несмотря на красоту модели Лары-Рьётора, в данной работе мы используем общепринятый закон Люси с $\beta = 0.08$, чтобы иметь возможность сравнивать наши результаты с другими работами по T Северной Короны.


\subsect{Потемнение к краю}

Звёзды не являются ламбертовскими источниками. Они имеют атмосферу ненулевой толщины, и, когда мы смотрим на поверхность под углом, свет проходит в атмосфере больший путь. Поэтому края звёзд кажутся более красными и тёмными, чем их центр.

Потемнение к краю определяется численно, с использованием моделей ATLAS и PHOENIX. Антоний Кларет показал, что его можно профитировать формулой
\begin{equation}
I = I_0 \cdot \brk2{
    1 - a_1 \brk!{1 - c^{1/2}} - a_2 \brk!{1 - c} - a_3 \brk!{1 - c^{3/2}} - a_4 \brk!{1 - c^2}
}
\label{eq:ClaretDarkening}
\end{equation}
где $c = \cos \theta$, $\theta$ --- угол между лучом зрения и нормалью к поверхности. Коэффициенты $a_i$ зависят от температуры, металличности и ускорения силы тяжести, Кларет приводит соответствующие таблицы \cite{ClaretDarkening}.

Температура и ускорение силы тяжести варьируются по поверхности звезды. Чтобы это учесть, мы интерполируем коэффициенты из таблиц.

В данной работе интерполяция осуществляется только по температуре. Зависимость от силы тяжести более слабая, и мы приняли, что на всей поверхности звезды $\log g = 4$ см/с+2.


\sect{Вычисление синтетических кривых блеска}

Вычисление синтетической кривой блеска происходит следующим образом:
\begin{enumerate}
    \item Вычисление формы звезды (полости Роша). Для этого мы сначала создаём сферическую сетку алгоритмом Катмулла-Кларка, затем для каждого направления $(n_x, n_y, n_z)$ вычисляем радиус такой, чтобы результирующая поверхность оказалась эквипотенциальной для потенциала \eqref{eq:roche_spherical}.
    \item Вычисление ускорения силы тяжести и температуры в каждой точке. Ускорение силы тяжести мы получаем, вычисляя $\nabla \Omega$ автоматическим дифференциированием с помощью дуальных чисел. Температуру мы вычисляем, используя закон Люси $T_\text{eff} = T_0 \brk2{\frac{g}{g_0}}^{0.08}$. В качестве $g_0$ и $T_0$ мы берем значения на экваторе звезды в точке, наиболее удаленной от «носика».
    \item Вычисление светимости в каждой точке. Мы используем формулу Планка для излучения абсолютно черного тела и сворачиваем её с полосой пропускания фильтра.
    \item Усреднение светимости в каждой грани и вычисление нормалей к граням.
    \item Вычисление коэффициентов потемнения к краю $a_i(T)$ для каждой грани.
    \item Вычисление суммарной светимости для разных фаз. Для этого при фиксированном направлении на наблюдателя мы вычисляем косинус угла между нормалью к грани и направлением на наблюдателя; определяем, какие грани видны, а какие нет; вычисляем потемнение к краю по формуле \eqref{eq:ClaretDarkening}; суммируем светимость по видимым граням.
    \item Преобразование к звёздной величине по формуле $m = -2.5 \log_{10} L$.
\end{enumerate}



\sect{Байесовский подход для обратной задачи}

Наша цель --- определить параметры двойной звезды (наклонение, соотношение масс). Для этого мы используем парадигму вероятностного программирования, в основе которой лежит байесовский подход.

Пусть $\theta$ --- параметры модели (наклонение, соотношение масс), $Y$ --- экспериментальные данные. Тогда по теореме Байеса апостериорное распределение параметров с учетом данных равно
\begin{equation}
P(\theta | Y) = \frac{P(Y | \theta) P(\theta)}{P(Y)}
\label{eq:bayes}
\end{equation}
В этой формуле:
\begin{itemize}
    \item $P(\theta)$ --- априорное распределение, которое часто можно взять равномерным,
    \item $P(Y | \theta)$ --- правдоподобие, которое можно вычислить, если сопоставить с погрешностью разность между измерениями и модельной кривой,
    \item $P(Y)$ --- полная вероятность получить набор данных --- не зависящая от $\theta$ нормировочная константа.
\end{itemize}

Апостериорное распределение по сути является ответом на задачу. Оно отражает все имеющиеся данные, с его помощью можно оценить параметры модели и их доверительные интервалы.


\subsect{Вероятностная модель}

Параметры, от которых зависит форма кривой блеска, приведены в таблице \ref{tab:model}. Некоторые из них известны и для них приведены числовые значения, некоторые являются случайными переменными, для них приведены априорные распределения.

\begin{table}[h]
\caption{\centering Параметры модели}
\label{tab:model}
\SetTblrInner{rowsep=0.2em}
\begin{tblr}{l X}
    \textbf{Параметры интереса:} \\

    $i \sim \operatorname{Uniform}(0, \pi/2)$ & наклонение орбиты \\

    $q \sim \operatorname{Uniform}(0.01, 10)$ & отношение массы карлика к массе гиганта \\[0.2em]

    \textbf{Скрытые переменные:} \\

    $\varphi_0 \sim \operatorname{Uniform}(-\pi, \pi)$ & фаза в первый день наблюдений \\

    $\text{offset}^{K, J} \sim \operatorname{Uniform}(-\infty, +\infty)$ & смещение звёздной величины в фильтрах $K$ и $J$, отражающее расстояние до звезды и её реальные размеры \\

    $\sigma_\text{common}^{K, J} \sim \operatorname{Uniform}(0, +\infty)$ & добавочная погрешность \\[0.2em]

    \textbf{Внешние данные:} \\

    $t$ & даты наблюдений \\

    $m^{K, J}_t$ & звёздная величина в фильтрах $K$ и $J$ \\

    $\sigma^{K, J}_t$ & фотометрическая погрешность звёздной величины \\

    $T \approx 3500\ {}^\circ \text{K}$ & температура красного гиганта, известная из спектрометрических наблюдений \\

    $P \approx 227 \text{ суток}$ & период, полученный с помощью периодограммы Ломба-Скаргла \\

    % \textbf{Модель:} \\[\rowspace]

    % $L_t^{K, J} = \text{model}(t, i, q, \varphi_0, T, P) + \text{offset}^{K, J}$ & вычисление синтетической кривой блеска \\[\rowspace]

    % $m_t^{K, J} \sim \operatorname{Normal}(L_t^{K, J}, \sigma_\text{common}^2 + \sigma_t^2)$
\end{tblr}
\end{table}

Эти параметры полностью задают кривую блеска:
\[
\tilde m_t^{K, J} = \text{model}(t, i, q, \varphi_0, T, P) + \text{offset}^{K, J}
\]
где $\text{model}$ --- функция, вычисляющая синтетическую кривую блеска.

Когда кривая блеска вычислена, можно вычислить правдоподобие, исходя из предположения, что экспериментальные значения распределены нормально около предсказанных:
\begin{equation}
m_t^{K, J} \sim \mathcal N (\tilde m_t^{K, J},\ \sigma_\text{common}^2 + \sigma_t^2)
\label{eq:normal}
\end{equation}

Таким образом, каждому набору параметров соответствует некоторая (ненормированная) апостериорная вероятность, складывающаяся из априорной вероятности и правдоподобия. Мы автоматизируем её вычисление с помощью библиотеки Turing.jl \cite{Turing}.

В формуле \eqref{eq:normal} мы приняли, что погрешность складывается из двух величин: погрешности измерений в конкретный день $\sigma_t$ и некоторой общей для всех точек погрешности $\sigma_\text{common}$. Мы ввели дополнительную погрешность, поскольку разброс точек на графике был больше, чем можно было бы ожидать от фотометрической погрешности. Вероятно, это связано с собственной быстрой переменностью звезды --- например, вызванной темными пятнами.


\subsect{Семплирование}

В то время как вычислить значение апостериорной вероятности в точке возможно, чтобы извлечь из неё полезную информацию (такую как маржинальное распределение), потребуется интегрировать её по многомерному пространству параметров.

Альтернативный подход --- семплирование, то есть генерация случайных наборов параметров, подчиняющихся интересующему нас распределению. Анализировать дискретные наборы точек гораздо проще. Очень просто вычислить медиану, среднее, доверительные интервалы и т.д.

Для нас удобны алгоритмы семплирования, которые могут работать с ненормированными распределениями. Это позволяет не вычислять нормировочную константу $P(Y)$ в формуле Байеса \eqref{eq:bayes}, для чего потребовалось бы интегрирование по пространству параметров.

Такая возможность есть у алгоритмов семплирования на марковских цепях (Markov Chain Monte Carlo, MCMC). В них каждая точка генерируется на основе предыдущей, затем она принимается или отбрасывается.

Часто используется правило принятия Метрополиса-Гастингса:
\begin{equation*}
\theta_{t+1} = \begin{cases}
    \theta' & \text{с вероятностью } \min\brk*{
        \frac{\rho(\theta')}{\rho(\theta_t)},
        1
    } \\
    \theta_t & \text{иначе}
\end{cases}
\end{equation*}
где $\rho(\theta)$ --- целевая плотность вероятности, $\theta_t$ --- текущая точка, $\theta'$ --- точка-кандидат.

Можно показать, что если алгоритм генерации точек-кандидатов удовлетворяет детальному балансу
\begin{equation}
P(\theta_1 \to \theta_2) = P(\theta_2 \to \theta_1)
\label{eq:balance}
\end{equation}
то распределение принятых точек будет стремиться к искомому.

Алгоритмы генерации точек-кандидатов могут быть разными. Можно, например, просто добавлять к текущей точке случайное смещение.

Мы используем алгоритм семплирования NUTS (No U-Turn Sampler) \cite{NUTS}. Он был предложен в 2011 году как вариация HMC (Hamiltonian Monte Carlo), не требующая ручного задания гиперпараметров.

В этих алгоритмах величина $\log \rho$ играет роль гамильтониана, под воздействием которого точка движется по пространству параметров. Поскольку уравнения гамильтоновой механики обратимы во времени и обладают свойством сохранения фазового объёма, условие детального равновесия \eqref{eq:balance} выполнено.

NUTS --- state-of-the-art алгоритм семплирования, который позволяет относительно эффективно исследовать пространство параметров. Однако ему требуется возможность вычислять производные $\log \rho$, поскольку они входят в уравнения движения точки. Мы используем для этого автоматическое дифференциирование с помощью дуальных чисел.



\sect{Данные}

\subsect{Фотометрические наблюдения}


\showbib

\end{document}
